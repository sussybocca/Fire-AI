<script>
const form = document.getElementById('chat-form');
const input = document.getElementById('chat-input');
const output = document.getElementById('chat-output');

// Dynamically load Puter.ai
function loadPuter() {
  return new Promise((resolve, reject) => {
    const s = document.createElement('script');
    s.src = 'https://js.puter.com/v2/';
    s.onload = () => resolve();
    s.onerror = () => reject(new Error('Failed to load Puter.ai'));
    document.head.appendChild(s);
  });
}

async function initChat() {
  try {
    await loadPuter(); // wait until script loads
  } catch(err) {
    output.innerHTML += `<p><b>AI:</b> ${err.message}</p>`;
    return;
  }

  form.addEventListener('submit', async e => {
    e.preventDefault();
    const question = input.value.trim();
    if(!question) return;

    output.innerHTML += `<p><b>You:</b> ${question}</p>`;
    input.value = "";

    try {
      const response = await puter.ai.chat(question, { model: "gpt-5-nano" });
      output.innerHTML += `<p><b>AI:</b> ${response}</p>`;
      output.scrollTop = output.scrollHeight;
    } catch(err) {
      output.innerHTML += `<p><b>AI:</b> Error: ${err.message}</p>`;
    }
  });
}

window.addEventListener('load', initChat);
</script>